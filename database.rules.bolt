// ---------------------------------------------------------------------------------------------------------------------
// PATHS
//

path /admins/{uid} is Boolean;

path /vouchers {
  read() { isAdmin() }
  write() { isAdmin() }

  path /available {
    index() { ["code", "createdAt"] }
    path /{key} is Voucher;
  }

  path /archive {
    index() { ["code", "expiresAt"] }
    path /{key} is Voucher;
  }
}

// ---------------------------------------------------------------------------------------------------------------------
// MODELS

type Voucher {
  isPrinted: Boolean|Null,
  code: String,
  createdAt: Number,
  expiresAt: Number,
  validFor: Number, // Number of seconds of valid uptime
  usages: Number,
  used: Number
}


// ---------------------------------------------------------------------------------------------------------------------
// FUNCTIONS

isAdmin() {
  auth != null && root.admins[auth.uid] == true
}